# Глава 5. Дублирование информации в таблицах

Обычно дублирование информации (одинаковые записи в таблице) - это зло, поскольку оно свидетельствует о том, что при проектировании базы данных что-то не было учтено. Иногда дублирование информации происходит случайно: дребезг клавиш (несколько быстрых нажатий вместо одного), случайный ввод данных повторно и т.д., иногда такие случайности являются скрытыми закономерностями, возникшими, например, в результате ошибки в программе, и не всегда есть возможность определить, имело ли место дублирование информации.

Предположим, что вы получили два письма, и оба - от некоего Иванова Ивана Ивановича, почему-то с разных адресов, при этом текст писем разный, но смысл примерно одинаковый - Иван Иванович хотел бы заключить с вашей компанией деловое соглашение и готов приехать обсудить его на ближайшей неделе. В этой ситуации возникает вопрос: были ли эти два письма написаны одним и тем же человеком или двумя разными? Вы понимаете, что ваш ответ может совпасть, а может не совпасть с реальностью. Тогда возможно такое развитие событий:

* вы угадали, и это один и тот же человек - вы отправили ему приглашение на один из адресов, и он приехал к вам на встречу с руководством, всё прошло хорошо.
* вы угадали, и это два разных человека - вы отправили им обоим приглашения на каждый из адресов, и они приехали на встречу с вашим руководством строго в назначенное каждому из них время, всё прошло хорошо.
* вы НЕ угадали, решив, что это два человека, на самом деле он был один, просто когда он писал вам письмо, компьютер с почтой "завис", и Иван Иванович решил, что письмо не отправилось, поэтому добрался до другого компьютера и написал заново - небольшой конфуз, ситуация в целом разрешилась, однако осадочек остался.
* вы НЕ угадали, решив, что это один человек (оказалось, что это два разных представителя двух разных фирм, нетерпимых по отношению друг к другу конкурентов), по одному адресу вы отправили письмо с ответом, а со вторым Иваном Ивановичем поговорили по телефону - он сам до вас дозвонился, и сказали ему, где и когда нужно оказаться, чтобы переговоры состоялись - в итоге на переговоры пришли оба Ивана Ивановича, переговоры были с треском провалены и теперь с вашей компанией не хотят иметь дела ни та, ни другая фирмы.

Предположим, что вы собираетесь хранить информацию о физических лицах, ваших клиентах или сотрудниках (вопросы, связанные с хранением персональных данных сейчас оставим "за бортом", предположим, что все требования законодательства выполняются) и собираетесь гарантировать уникальность записей (т.е. то, что одному человеку будет соответствовать строго одна запись в таблице). Как это реализовать? Казалось бы, каждого из нас однозначно идентифицирует фамилия, имя и отчество. Хотя... был у меня один студент, Пушкин... Александр Сергеевич. Правда, год рождения совершенно другой. Хорошо, добавляем к ФИО дату рождения - и отлавливаем ситуацию, когда в семье родились два мальчика (или девочки - не суть важно), в один и тот же день, и им дали одинаковые имена (намеренно или по ошибке). Если вы определите требование уникальности записи по ФИО и дате рождения, то первого вы внесёте в таблицу, а второго - уже нет. Тогда можно добавить какой-то другой идентификатор в зависимости от доступности и допустимости использования этого идентификатора (номер мобильного телефона, паспорта, домашний адрес, ИНН, СНИЛС, номер свидетельства о рождении, что-то ещё). Нужно помнить, что сменить номер телефона ничего не стоит, паспорт и свидетельство о рождении можно поменять (и их номера и даты выдачи станут другими), домашний адрес - сложно проверить и также можно сменить, ИНН и СНИЛС более-менее стабильны во времени, но не всегда их использование будет удобным и допустимым.

В общем, порой гарантировать уникальность каждого объекта, внесённого в таблицу, бывает очень сложно. Но всегда ли это нужно делать? Например, вы разрабатываете сайт и регистрируете пользователей, чтобы они могли оставлять комментарии. Для идентификации пользователя вам достаточно знать адрес его электронной почты или номер мобильного телефона. Казалось бы, пользователь легко может сменить и то, и другое. Да, действительно, и в вашей базе у пользователя окажется несколько разных учётных записей. Но так ли это плохо для вашей системы, если задачи идентификации в нужном ей объёме она выполняет?





